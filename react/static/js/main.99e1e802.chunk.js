(window["webpackJsonpfile-sharing-react"]=window["webpackJsonpfile-sharing-react"]||[]).push([[0],{39:function(e){e.exports=JSON.parse('{"host":"file-peer.herokuapp.com","path":"/myapp","secure":true,"port":443,"key":"peerjs","debug":3}')},50:function(e,n,t){e.exports=t(82)},55:function(e,n,t){},59:function(e,n){function t(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=59},79:function(e,n,t){},82:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(34),i=t.n(o),c=(t(55),t(35)),u=t(46),l=t(43),s=t(8),f=t(11),p=t(12),d=t(14),h=t(13),m=t(9),b=t(15),v=t(2),g=t(3);function O(){var e=Object(v.a)(["\n  float: left;\n"]);return O=function(){return e},e}function j(){var e=Object(v.a)(["\n  width: 100%;\n  background-color: #4caf50;\n  color: white;\n  padding: 14px 20px;\n  margin: 8px 0;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n"]);return j=function(){return e},e}function w(){var e=Object(v.a)(["\n  width: 100%;\n  padding: 12px 20px;\n  margin: 8px 0;\n  display: inline-block;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  box-sizing: border-box;\n"]);return w=function(){return e},e}function y(){var e=Object(v.a)(["\n  margin: 8px 240px;\n  padding: 40px;\n  background-color: #f2f2f2;\n  border-radius: 5px;\n"]);return y=function(){return e},e}var k=g.a.div(y()),E=g.a.input(w()),x=g.a.input(j()),D=g.a.label(O()),S=function(e){function n(e){var t;return Object(f.a)(this,n),(t=Object(d.a)(this,Object(h.a)(n).call(this,e))).state={value:""},t.handleSubmit=t.handleSubmit.bind(Object(m.a)(t)),t.handleChange=t.handleChange.bind(Object(m.a)(t)),t}return Object(b.a)(n,e),Object(p.a)(n,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.history.push("/share"),this.props.store.setName(this.state.value)}},{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"render",value:function(){return a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement(k,null,a.a.createElement(D,null,"Name:"),a.a.createElement(E,{value:this.state.value,onChange:this.handleChange}),a.a.createElement(x,{type:"submit",value:"Submit"})))}}]),n}(a.a.Component),C=t(47),I=t(38),F=t.n(I),P=t(18),N=t.n(P),T=t(39),U=t(40),A=t.n(U),B=t(41),M=t.n(B),Y=t(42),J=t.n(Y);function L(){var e=Object(v.a)(["\n  margin-top: 4px;\n  padding: 8px;\n  background-color: #5f5f67;\n  border-radius: 4px;\n"]);return L=function(){return e},e}function R(){var e=Object(v.a)(["\n  color: grey;\n"]);return R=function(){return e},e}function W(){var e=Object(v.a)(["\n  font-weight: bold;\n  margin-right: 8px;\n"]);return W=function(){return e},e}function _(){var e=Object(v.a)(["\n  margin-top: 12px;\n"]);return _=function(){return e},e}function q(){var e=Object(v.a)(["\n  display: block;\n  color: white;\n"]);return q=function(){return e},e}function z(){var e=Object(v.a)(["\n  text-align: left;\n  list-style: none;\n  background: #45454d;\n  padding: 40px;\n  margin: 0;\n"]);return z=function(){return e},e}var G=g.a.ul(z()),H=g.a.li(q()),V=g.a.div(_()),$=g.a.span(W()),K=g.a.span(R()),Q=g.a.div(L());function X(e){return e.file.valid&&e.file.ownerId!==e.id?a.a.createElement("button",{onClick:function(){return function(e,n,t){if(null!==e){var r=e.connect(n);r.on("open",(function(){console.log("send"),r.send(t),console.log("wait"),r.on("data",(function(e){if(e.error)r.close();else{var n=window.URL.createObjectURL(new Blob([new Uint8Array(e.buffer,0,e.buffer.length)])),t=document.createElement("a");t.href=n,t.setAttribute("download",e.name),t.click()}}))}))}}(e.peer,e.file.ownerId,e.file.guid,e.file.valid)}},"Dowload"):null}var Z=function(e){function n(){return Object(f.a)(this,n),Object(d.a)(this,Object(h.a)(n).apply(this,arguments))}return Object(b.a)(n,e),Object(p.a)(n,[{key:"getDate",value:function(e){return J()(e).format("DD/MM/YYYY, H:mm:ss")}},{key:"render",value:function(){var e=this;return a.a.createElement(G,null,this.props.files.map((function(n,t){return a.a.createElement(H,{key:t},a.a.createElement(V,null,a.a.createElement($,null,n.owner),a.a.createElement(K,null,e.getDate(n.date)," ",n.ownerId)),a.a.createElement(Q,null,n.name,a.a.createElement(X,{peer:e.props.peer,file:n,id:e.props.id})))})))}}]),n}(a.a.Component);function ee(){var e=Object(v.a)(["\n  height: 40px;\n  background-color: gray;\n  color: white;\n  font-weight: bold;\n  padding-top: 8px;\n"]);return ee=function(){return e},e}var ne=g.a.div(ee()),te=function(e){function n(e){var t;return Object(f.a)(this,n),(t=Object(d.a)(this,Object(h.a)(n).call(this,e))).state={fetching:!1,peer:null,id:-1,files:[],shared:[]},M()(Object(m.a)(t)),t}return Object(b.a)(n,e),Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;if(null!==this.props.store.name){this.fetchFilesInfo();var n=new F.a(T);n.on("open",(function(t){N.a.put("".concat("https://file-peer.herokuapp.com","/users/"),{name:e.props.store.name,id:t}),console.log("User id: ".concat(t)),e.setState({peer:n,id:t})})),n.on("connection",(function(n){n.on("data",(function(t){var r=e.state.shared.map((function(e){return e.uuid})).indexOf(t);if(-1===r)return console.error("Requested file does'nt exist!"),void n.send({error:!0});console.log("Send buffer");var a=e.state.shared[r].file.name;console.log("Send ".concat(e.state.shared[r].file.name)),e.state.shared[r].file.arrayBuffer().then((function(e){console.log("Send buffer"),n.send({name:a,buffer:e}),console.log("Close")}))}))})),this.setState({fetching:!0})}else this.props.history.push("/")}},{key:"handleDrop",value:function(e){e.preventDefault();var n=null;if(e.dataTransfer.items){n=[];for(var t=0;t<e.dataTransfer.items.length;t++)"file"===e.dataTransfer.items[t].kind&&n.push(e.dataTransfer.items[t].getAsFile())}else n=e.dataTransfer.files;this.shareFiles(n,this.props.store.name),n.forEach((function(e){console.log("file.name = "+e.name)}))}},{key:"shareFiles",value:function(e,n){var t=this,r=Object(C.a)(this.state.shared);e.forEach((function(e){var a={file:e,uuid:A()()};r.push(a),N.a.post("".concat("https://file-peer.herokuapp.com","/files/"),{owner:n,name:e.name,guid:a.uuid}).then((function(){t.fetchFilesInfo()}))})),this.setState({shared:r})}},{key:"fetchFilesInfo",value:function(){var e=this;N.a.get("".concat("https://file-peer.herokuapp.com","/files/")).then((function(n){e.setState({files:n.data,fetching:!1}),e.el.scrollIntoView({behavior:"smooth"})})).catch((function(n){console.log("Got error: ".concat(n)),e.setState({fetching:!1,error:n})}))}},{key:"handleDragOver",value:function(e){e.preventDefault()}},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,this.state.fetching?a.a.createElement("h1",null,"'Fetching'"):null,a.a.createElement(Z,{peer:this.state.peer,files:this.state.files,id:this.state.id}),a.a.createElement(ne,{onDrop:this.handleDrop,onDragOver:this.handleDragOver,ref:function(n){e.el=n}},"Drop files to upload"))}}]),n}(a.a.Component);t(79);function re(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}var ae=function(){var e=Object(r.useState)({name:null,loggedIn:!1,setName:function(e){return o(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?re(t,!0).forEach((function(n){Object(c.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):re(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},t,{name:e}))}}),n=Object(u.a)(e,2),t=n[0],o=n[1];return a.a.createElement("div",{className:"App"},a.a.createElement(l.a,null,a.a.createElement(s.a,{path:"/",exact:!0,render:function(e){return a.a.createElement(S,Object.assign({},e,{store:t}))}}),a.a.createElement(s.a,{path:"/share",exact:!0,render:function(e){return a.a.createElement(te,Object.assign({},e,{store:t}))}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[50,1,2]]]);
//# sourceMappingURL=main.99e1e802.chunk.js.map